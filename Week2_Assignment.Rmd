Week 2 Assignment
==============================

###Load and Preprocess the data
#### Load Parameters and libraries

We will first load the paremeters to read in the file.

```{r Load Parameters}
fileName <- "activity.csv"

library(ggplot2)
library(dplyr)
```

WeÂ´ll now proceed to read the file into a dataframe.

```{r Read data}

df <- read.csv(fileName, header = T)
str(df)

```

#### Preprocessing

Before analyzing the dataset, we will run the following pre-processing steps.

1. Convert 'data' variable into date format
2. convert 'interval' variable to factor


Convert variables to their corresponding classes.

```{r Preprocessing}
df$date <- as.Date(df$date, "%Y-%m-%d")

str(df)
```

### What is the mean total number of steps taken per day?

#### Histogram of the total number of steps taken each day.

```{r Histogram, warning=F, fig.align= 'center'}
grouped <- group_by(df, date)
grouped <- summarise_all(grouped, sum)
ggplot(grouped, aes(x = steps)) + geom_histogram(bins=30) + ggtitle("Total Number of Steps per day") +
    ylab("Counts") +
    xlab("Number of steps (daily)")

```

#### Mean and Median total number of steps taken per day

```{r Mean and Median,echo=F}

print(paste0("Average number of steps per day: ",round(mean(grouped$steps, na.rm=T),0)))

print(paste0("Median number of steps per day: ",round(median(grouped$steps, na.rm=T),0)))

```

```{r Export Histogram, echo =F, warning=FALSE}
png("./instructions_fig/Histogram.png")
grouped <- group_by(df, date)
grouped <- summarise_all(grouped, sum)
ggplot(grouped, aes(x = steps)) + geom_histogram(bins=30) + ggtitle("Total Number of Steps per day") +
    ylab("Counts") +
    xlab("Number of steps (daily)")

dev.off()

```

### What is the average daily activity pattern?

#### Plot the 5 minute interval versus the average number of steps taken per day

```{r Time Series, fig.align="center"}
#Group observations by inverval
int_group <- select(df, steps, interval)
int_group <- group_by(int_group, interval)
#Calculate the average number of steps by interval (use na.rm to handle missingness)
int_group <- summarise(int_group, AverageSteps = mean(steps, na.rm=T))

#plot(int_group$interval, int_group$AverageSteps, type ="l")
p <- ggplot(int_group, aes(x=interval, y=AverageSteps))
p + geom_line()+
    xlab("Intervals")+
    ylab("Average Steps")+
    ggtitle("Average Number of Steps by Interval")

```

```{r Export Time Series, echo=F, warning=FALSE}
png("./instructions_fig/AverageStepsTimeSeries.png")
p + geom_line()+
    xlab("Intervals")+
    ylab("Average Steps")+
    ggtitle("Average Number of Steps by Interval")
dev.off()

```


#### Determine the Interval with maximum average steps per day

We can see that the maximum average steps take place at the "8:35AM" time interval.

```{r Maximum Steps}
index <- which.max(int_group$AverageSteps)
print(int_group[index,])
```